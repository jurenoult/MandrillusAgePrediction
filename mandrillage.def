Bootstrap: docker
From: pytorch/pytorch:2.0.1-cuda11.7-cudnn8-devel
Stage: build

%environment
    MANDRILLAGE_SRC=/mandrillage

%files
    config /mandrillage/config
    mandrillage /mandrillage/mandrill
    notebooks /mandrillage/notebooks
    requirements.txt /mandrillage/requirements.txt
    setup.py /mandrillage/setup.py

%post
    apt-get update -y
    DEBIAN_FRONTEND=noninteractive TZ=Etc/UTC apt-get -y install tzdata libglib2.0-0 libsm6 libxrender1 libfontconfig1 libxtst6
    cd /mandrillage
    pip install -r requirements.txt
pipeline:
  _target_: mandrillage.pipelines.regression_ranking.RegressionRankingPipeline

name: "regression_ranking"
train: True
test: True
resume: False

kfold: 0

dataset:
  basepath: "data/db2/"
  metadata: "MFD_metadatas.csv"
  images: "Images"
  max_age: 3
  dob_certain_only: False
  max_dob_error: 15
  in_memory: True
  n_classes: 3
  same_age_gap: 0
  sex: null

training:
  learning_rate: 0.00001
  batch_size: 16
  epochs: 100
  ranking_learning_rate: 0.00001
  ranking_alpha: 1
  sim_alpha: 0
  linear_weighting:
    min_age_error_max: 5
    max_age_error_max: 30

model:
  pretrained: data/pretrained/VGG_FACE.t7
  vgg_start_filters: 64
  vgg_output_dim: 2622

  # Number of dense neurons at first layer
  regression_lin_start: 2048
  # Number of stages in the regression head.
  # Each stage divides the number of neurons by two
  regression_stages: 6

  classification_lin_start: ${experiment.model.regression_lin_start}
  classification_stages: ${experiment.model.regression_stages}
